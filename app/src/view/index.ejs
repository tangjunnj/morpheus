<html>
<head>
    <script language="javascript" src="http://cdn.bootcss.com/jquery/3.2.1/jquery.js"></script>
    <script language="javascript" src="http://cdn.bootcss.com/jquery.form/4.2.0/jquery.form.js"></script>
</head>
<body>
    <table>
        <tr>
            <td>url</td>
            <td>resp</td>
            <td>operation</td>
        </tr>
        <%if(routes.routes){

        for (let i = 0;i<routes.routes.length;i++){%>
        <tr >
            <td>
                <input type="text" name = "url" value="<%=routes.routes[i].url%>" />
            </td>
            <td>
                <textArea name = "resp" cols="200"  ><%=JSON.stringify(routes.routes[i].resp)%></textArea>
            </td>
            <td>
                <input type="button" value="删除" onclick="location='/console/delRoute?id=<%=routes.routes[i].id%>'"/>

            </td>
        </tr>
        <%}%>

        <%}%>
        <tr>
            <td>
                <input id="addUrl" type="text" name = "addUrl" value="" />
            </td>
            <td>
                <textArea id="addResp" name = "addResp" cols="200"  ></textArea>
            </td>
            <td>
                <input type="button" value="新增" onclick="addRoute()"/>
            </td>
        </tr>
    </table>
    <input type="button" value="刷新" onclick="location='/console/refresh'"/>


<script text="javascrpt">
    function addRoute() {
        var addUrl = $('#addUrl').val();
        console.log(addUrl)
        var addResp = $('#addResp').val();
        console.log(addResp)
        $.ajax({
            url:"/console/addRoute",
            async:false,
            data:{
                "addUrl":addUrl,
                "addResp":addResp
            },
            type:'POST',
            success:function(res){
                console.log(res)
                if (res.status == 1) {
                    window.location.href="/console/show";
                } else {
                    alert(res.message);
                }
            }
        });
    }


</script>

</body>
</html>
